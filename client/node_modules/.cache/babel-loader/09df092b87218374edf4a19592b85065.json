{"ast":null,"code":"'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _util = require('./util');\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    'default': obj\n  };\n}\n\nvar DEFAULT_NODE_SELECTOR = 'tr';\nvar DIRECTIONS = {\n  TOP: 1,\n  BOTTOM: 3\n};\nvar UNIT_PX = 'px';\nvar DRAG_LIND_STYLE = 'position:fixed;z-index:9999;height:0;' + 'margin-top:-1px;border-bottom:dashed 2px red;display:none;';\n\nvar ReactDragListView = function (_Component) {\n  (0, _inherits3['default'])(ReactDragListView, _Component);\n\n  function ReactDragListView(props) {\n    (0, _classCallCheck3['default'])(this, ReactDragListView);\n\n    var _this = (0, _possibleConstructorReturn3['default'])(this, (ReactDragListView.__proto__ || Object.getPrototypeOf(ReactDragListView)).call(this, props));\n\n    _this.onMouseDown = _this.onMouseDown.bind(_this);\n    _this.onDragStart = _this.onDragStart.bind(_this);\n    _this.onDragEnter = _this.onDragEnter.bind(_this);\n    _this.onDragEnd = _this.onDragEnd.bind(_this);\n    _this.autoScroll = _this.autoScroll.bind(_this);\n    _this.state = {\n      fromIndex: -1,\n      toIndex: -1\n    };\n    _this.scrollElement = null;\n    _this.scrollTimerId = -1;\n    _this.direction = DIRECTIONS.BOTTOM;\n    return _this;\n  }\n\n  (0, _createClass3['default'])(ReactDragListView, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this.dragLine && this.dragLine.parentNode) {\n        this.dragLine.parentNode.removeChild(this.dragLine);\n        this.dragLine = null;\n        this.cacheDragTarget = null;\n      }\n    }\n  }, {\n    key: 'onMouseDown',\n    value: function onMouseDown(e) {\n      var handle = this.getHandleNode(e.target);\n\n      if (handle) {\n        var target = !this.props.handleSelector || this.props.handleSelector === this.props.nodeSelector ? handle : this.getDragNode(handle);\n\n        if (target) {\n          handle.setAttribute('draggable', false);\n          target.setAttribute('draggable', true);\n          target.ondragstart = this.onDragStart;\n          target.ondragend = this.onDragEnd;\n        }\n      }\n    }\n  }, {\n    key: 'onDragStart',\n    value: function onDragStart(e) {\n      var target = this.getDragNode(e.target);\n      var eventData = e;\n\n      if (target) {\n        var parentNode = target.parentNode;\n        eventData.dataTransfer.setData('Text', '');\n        eventData.dataTransfer.effectAllowed = 'move';\n        parentNode.ondragenter = this.onDragEnter;\n\n        parentNode.ondragover = function (ev) {\n          ev.preventDefault();\n          return true;\n        };\n\n        var fromIndex = (0, _util.getDomIndex)(target, this.props.ignoreSelector);\n        this.setState({\n          fromIndex: fromIndex,\n          toIndex: fromIndex\n        });\n        this.scrollElement = (0, _util.getScrollElement)(parentNode);\n      }\n    }\n  }, {\n    key: 'onDragEnter',\n    value: function onDragEnter(e) {\n      var target = this.getDragNode(e.target);\n      var eventData = e;\n      var toIndex = void 0;\n\n      if (target) {\n        toIndex = (0, _util.getDomIndex)(target, this.props.ignoreSelector);\n\n        if (this.props.enableScroll) {\n          this.resolveAutoScroll(eventData, target);\n        }\n      } else {\n        toIndex = -1;\n        this.stopAutoScroll();\n      }\n\n      this.cacheDragTarget = target;\n      this.setState({\n        toIndex: toIndex\n      });\n      this.fixDragLine(target);\n    }\n  }, {\n    key: 'onDragEnd',\n    value: function onDragEnd(e) {\n      var target = this.getDragNode(e.target);\n      this.stopAutoScroll();\n\n      if (target) {\n        target.removeAttribute('draggable');\n        target.ondragstart = null;\n        target.ondragend = null;\n        target.parentNode.ondragenter = null;\n        target.parentNode.ondragover = null;\n\n        if (this.state.fromIndex >= 0 && this.state.fromIndex !== this.state.toIndex) {\n          this.props.onDragEnd(this.state.fromIndex, this.state.toIndex);\n        }\n      }\n\n      this.hideDragLine();\n      this.setState({\n        fromIndex: -1,\n        toIndex: -1\n      });\n    }\n  }, {\n    key: 'getDragNode',\n    value: function getDragNode(target) {\n      return (0, _util.closest)(target, this.props.nodeSelector, this.dragList);\n    }\n  }, {\n    key: 'getHandleNode',\n    value: function getHandleNode(target) {\n      return (0, _util.closest)(target, this.props.handleSelector || this.props.nodeSelector, this.dragList);\n    }\n  }, {\n    key: 'getDragLine',\n    value: function getDragLine() {\n      if (!this.dragLine) {\n        this.dragLine = window.document.createElement('div');\n        this.dragLine.setAttribute('style', DRAG_LIND_STYLE);\n        window.document.body.appendChild(this.dragLine);\n      }\n\n      this.dragLine.className = this.props.lineClassName || '';\n      return this.dragLine;\n    }\n  }, {\n    key: 'resolveAutoScroll',\n    value: function resolveAutoScroll(e, target) {\n      if (!this.scrollElement) {\n        return;\n      }\n\n      var _scrollElement$getBou = this.scrollElement.getBoundingClientRect(),\n          top = _scrollElement$getBou.top,\n          height = _scrollElement$getBou.height;\n\n      var targetHeight = target.offsetHeight;\n      var pageY = e.pageY;\n      var compatibleHeight = targetHeight * (2 / 3);\n      this.direction = 0;\n\n      if (pageY > top + height - compatibleHeight) {\n        this.direction = DIRECTIONS.BOTTOM;\n      } else if (pageY < top + compatibleHeight) {\n        this.direction = DIRECTIONS.TOP;\n      }\n\n      if (this.direction) {\n        if (this.scrollTimerId < 0) {\n          this.scrollTimerId = setInterval(this.autoScroll, 20);\n        }\n      } else {\n        this.stopAutoScroll();\n      }\n    }\n  }, {\n    key: 'stopAutoScroll',\n    value: function stopAutoScroll() {\n      clearInterval(this.scrollTimerId);\n      this.scrollTimerId = -1;\n      this.fixDragLine(this.cacheDragTarget);\n    }\n  }, {\n    key: 'autoScroll',\n    value: function autoScroll() {\n      var scrollTop = this.scrollElement.scrollTop;\n\n      if (this.direction === DIRECTIONS.BOTTOM) {\n        this.scrollElement.scrollTop = scrollTop + this.props.scrollSpeed;\n\n        if (scrollTop === this.scrollElement.scrollTop) {\n          this.stopAutoScroll();\n        }\n      } else if (this.direction === DIRECTIONS.TOP) {\n        this.scrollElement.scrollTop = scrollTop - this.props.scrollSpeed;\n\n        if (this.scrollElement.scrollTop <= 0) {\n          this.stopAutoScroll();\n        }\n      } else {\n        this.stopAutoScroll();\n      }\n    }\n  }, {\n    key: 'hideDragLine',\n    value: function hideDragLine() {\n      if (this.dragLine) {\n        this.dragLine.style.display = 'none';\n      }\n    }\n  }, {\n    key: 'fixDragLine',\n    value: function fixDragLine(target) {\n      var dragLine = this.getDragLine();\n\n      if (!target || this.state.fromIndex < 0 || this.state.fromIndex === this.state.toIndex) {\n        this.hideDragLine();\n        return;\n      }\n\n      var _target$getBoundingCl = target.getBoundingClientRect(),\n          left = _target$getBoundingCl.left,\n          top = _target$getBoundingCl.top,\n          width = _target$getBoundingCl.width,\n          height = _target$getBoundingCl.height;\n\n      var lineTop = this.state.toIndex < this.state.fromIndex ? top : top + height;\n\n      if (this.props.enableScroll && this.scrollElement) {\n        var _scrollElement$getBou2 = this.scrollElement.getBoundingClientRect(),\n            scrollHeight = _scrollElement$getBou2.height,\n            scrollTop = _scrollElement$getBou2.top;\n\n        if (lineTop < scrollTop - 2 || lineTop > scrollTop + scrollHeight + 2) {\n          this.hideDragLine();\n          return;\n        }\n      }\n\n      dragLine.style.left = left + UNIT_PX;\n      dragLine.style.width = width + UNIT_PX;\n      dragLine.style.top = lineTop + UNIT_PX;\n      dragLine.style.display = 'block';\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      return _react2['default'].createElement('div', {\n        role: 'presentation',\n        onMouseDown: this.onMouseDown,\n        ref: function ref(c) {\n          _this2.dragList = c;\n        }\n      }, this.props.children);\n    }\n  }]);\n  return ReactDragListView;\n}(_react.Component);\n\nReactDragListView.propTypes = {\n  onDragEnd: _propTypes2['default'].func.isRequired,\n  handleSelector: _propTypes2['default'].string,\n  nodeSelector: _propTypes2['default'].string,\n  ignoreSelector: _propTypes2['default'].string,\n  enableScroll: _propTypes2['default'].bool,\n  scrollSpeed: _propTypes2['default'].number,\n  lineClassName: _propTypes2['default'].string,\n  children: _propTypes2['default'].node\n};\nReactDragListView.defaultProps = {\n  nodeSelector: DEFAULT_NODE_SELECTOR,\n  ignoreSelector: '',\n  enableScroll: true,\n  scrollSpeed: 10,\n  handleSelector: '',\n  lineClassName: '',\n  children: null\n};\nexports['default'] = ReactDragListView;\nmodule.exports = exports['default'];","map":{"version":3,"sources":["C:/1. Eizeiky/3. React/dumbways react/minggu_4 - Presentasi Final test/client/node_modules/react-drag-listview/lib/ReactDragListView.js"],"names":["Object","defineProperty","exports","value","_classCallCheck2","require","_classCallCheck3","_interopRequireDefault","_createClass2","_createClass3","_possibleConstructorReturn2","_possibleConstructorReturn3","_inherits2","_inherits3","_react","_react2","_propTypes","_propTypes2","_util","obj","__esModule","DEFAULT_NODE_SELECTOR","DIRECTIONS","TOP","BOTTOM","UNIT_PX","DRAG_LIND_STYLE","ReactDragListView","_Component","props","_this","__proto__","getPrototypeOf","call","onMouseDown","bind","onDragStart","onDragEnter","onDragEnd","autoScroll","state","fromIndex","toIndex","scrollElement","scrollTimerId","direction","key","componentWillUnmount","dragLine","parentNode","removeChild","cacheDragTarget","e","handle","getHandleNode","target","handleSelector","nodeSelector","getDragNode","setAttribute","ondragstart","ondragend","eventData","dataTransfer","setData","effectAllowed","ondragenter","ondragover","ev","preventDefault","getDomIndex","ignoreSelector","setState","getScrollElement","enableScroll","resolveAutoScroll","stopAutoScroll","fixDragLine","removeAttribute","hideDragLine","closest","dragList","getDragLine","window","document","createElement","body","appendChild","className","lineClassName","_scrollElement$getBou","getBoundingClientRect","top","height","targetHeight","offsetHeight","pageY","compatibleHeight","setInterval","clearInterval","scrollTop","scrollSpeed","style","display","_target$getBoundingCl","left","width","lineTop","_scrollElement$getBou2","scrollHeight","render","_this2","role","ref","c","children","Component","propTypes","func","isRequired","string","bool","number","node","defaultProps","module"],"mappings":"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","sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');\n\nvar _classCallCheck3 = _interopRequireDefault(_classCallCheck2);\n\nvar _createClass2 = require('babel-runtime/helpers/createClass');\n\nvar _createClass3 = _interopRequireDefault(_createClass2);\n\nvar _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');\n\nvar _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);\n\nvar _inherits2 = require('babel-runtime/helpers/inherits');\n\nvar _inherits3 = _interopRequireDefault(_inherits2);\n\nvar _react = require('react');\n\nvar _react2 = _interopRequireDefault(_react);\n\nvar _propTypes = require('prop-types');\n\nvar _propTypes2 = _interopRequireDefault(_propTypes);\n\nvar _util = require('./util');\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { 'default': obj }; }\n\nvar DEFAULT_NODE_SELECTOR = 'tr';\nvar DIRECTIONS = {\n  TOP: 1,\n  BOTTOM: 3\n};\nvar UNIT_PX = 'px';\nvar DRAG_LIND_STYLE = 'position:fixed;z-index:9999;height:0;' + 'margin-top:-1px;border-bottom:dashed 2px red;display:none;';\n\nvar ReactDragListView = function (_Component) {\n  (0, _inherits3['default'])(ReactDragListView, _Component);\n\n  function ReactDragListView(props) {\n    (0, _classCallCheck3['default'])(this, ReactDragListView);\n\n    var _this = (0, _possibleConstructorReturn3['default'])(this, (ReactDragListView.__proto__ || Object.getPrototypeOf(ReactDragListView)).call(this, props));\n\n    _this.onMouseDown = _this.onMouseDown.bind(_this);\n    _this.onDragStart = _this.onDragStart.bind(_this);\n    _this.onDragEnter = _this.onDragEnter.bind(_this);\n    _this.onDragEnd = _this.onDragEnd.bind(_this);\n    _this.autoScroll = _this.autoScroll.bind(_this);\n\n    _this.state = {\n      fromIndex: -1,\n      toIndex: -1\n    };\n\n    _this.scrollElement = null;\n    _this.scrollTimerId = -1;\n    _this.direction = DIRECTIONS.BOTTOM;\n    return _this;\n  }\n\n  (0, _createClass3['default'])(ReactDragListView, [{\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      if (this.dragLine && this.dragLine.parentNode) {\n        this.dragLine.parentNode.removeChild(this.dragLine);\n        this.dragLine = null;\n        this.cacheDragTarget = null;\n      }\n    }\n  }, {\n    key: 'onMouseDown',\n    value: function onMouseDown(e) {\n      var handle = this.getHandleNode(e.target);\n      if (handle) {\n        var target = !this.props.handleSelector || this.props.handleSelector === this.props.nodeSelector ? handle : this.getDragNode(handle);\n        if (target) {\n          handle.setAttribute('draggable', false);\n          target.setAttribute('draggable', true);\n          target.ondragstart = this.onDragStart;\n          target.ondragend = this.onDragEnd;\n        }\n      }\n    }\n  }, {\n    key: 'onDragStart',\n    value: function onDragStart(e) {\n      var target = this.getDragNode(e.target);\n      var eventData = e;\n      if (target) {\n        var parentNode = target.parentNode;\n\n        eventData.dataTransfer.setData('Text', '');\n        eventData.dataTransfer.effectAllowed = 'move';\n        parentNode.ondragenter = this.onDragEnter;\n        parentNode.ondragover = function (ev) {\n          ev.preventDefault();\n          return true;\n        };\n        var fromIndex = (0, _util.getDomIndex)(target, this.props.ignoreSelector);\n        this.setState({ fromIndex: fromIndex, toIndex: fromIndex });\n        this.scrollElement = (0, _util.getScrollElement)(parentNode);\n      }\n    }\n  }, {\n    key: 'onDragEnter',\n    value: function onDragEnter(e) {\n      var target = this.getDragNode(e.target);\n      var eventData = e;\n      var toIndex = void 0;\n      if (target) {\n        toIndex = (0, _util.getDomIndex)(target, this.props.ignoreSelector);\n        if (this.props.enableScroll) {\n          this.resolveAutoScroll(eventData, target);\n        }\n      } else {\n        toIndex = -1;\n        this.stopAutoScroll();\n      }\n      this.cacheDragTarget = target;\n      this.setState({ toIndex: toIndex });\n      this.fixDragLine(target);\n    }\n  }, {\n    key: 'onDragEnd',\n    value: function onDragEnd(e) {\n      var target = this.getDragNode(e.target);\n      this.stopAutoScroll();\n      if (target) {\n        target.removeAttribute('draggable');\n        target.ondragstart = null;\n        target.ondragend = null;\n        target.parentNode.ondragenter = null;\n        target.parentNode.ondragover = null;\n        if (this.state.fromIndex >= 0 && this.state.fromIndex !== this.state.toIndex) {\n          this.props.onDragEnd(this.state.fromIndex, this.state.toIndex);\n        }\n      }\n      this.hideDragLine();\n      this.setState({ fromIndex: -1, toIndex: -1 });\n    }\n  }, {\n    key: 'getDragNode',\n    value: function getDragNode(target) {\n      return (0, _util.closest)(target, this.props.nodeSelector, this.dragList);\n    }\n  }, {\n    key: 'getHandleNode',\n    value: function getHandleNode(target) {\n      return (0, _util.closest)(target, this.props.handleSelector || this.props.nodeSelector, this.dragList);\n    }\n  }, {\n    key: 'getDragLine',\n    value: function getDragLine() {\n      if (!this.dragLine) {\n        this.dragLine = window.document.createElement('div');\n        this.dragLine.setAttribute('style', DRAG_LIND_STYLE);\n        window.document.body.appendChild(this.dragLine);\n      }\n      this.dragLine.className = this.props.lineClassName || '';\n      return this.dragLine;\n    }\n  }, {\n    key: 'resolveAutoScroll',\n    value: function resolveAutoScroll(e, target) {\n      if (!this.scrollElement) {\n        return;\n      }\n\n      var _scrollElement$getBou = this.scrollElement.getBoundingClientRect(),\n          top = _scrollElement$getBou.top,\n          height = _scrollElement$getBou.height;\n\n      var targetHeight = target.offsetHeight;\n      var pageY = e.pageY;\n\n      var compatibleHeight = targetHeight * (2 / 3);\n      this.direction = 0;\n      if (pageY > top + height - compatibleHeight) {\n        this.direction = DIRECTIONS.BOTTOM;\n      } else if (pageY < top + compatibleHeight) {\n        this.direction = DIRECTIONS.TOP;\n      }\n      if (this.direction) {\n        if (this.scrollTimerId < 0) {\n          this.scrollTimerId = setInterval(this.autoScroll, 20);\n        }\n      } else {\n        this.stopAutoScroll();\n      }\n    }\n  }, {\n    key: 'stopAutoScroll',\n    value: function stopAutoScroll() {\n      clearInterval(this.scrollTimerId);\n      this.scrollTimerId = -1;\n      this.fixDragLine(this.cacheDragTarget);\n    }\n  }, {\n    key: 'autoScroll',\n    value: function autoScroll() {\n      var scrollTop = this.scrollElement.scrollTop;\n\n      if (this.direction === DIRECTIONS.BOTTOM) {\n        this.scrollElement.scrollTop = scrollTop + this.props.scrollSpeed;\n        if (scrollTop === this.scrollElement.scrollTop) {\n          this.stopAutoScroll();\n        }\n      } else if (this.direction === DIRECTIONS.TOP) {\n        this.scrollElement.scrollTop = scrollTop - this.props.scrollSpeed;\n        if (this.scrollElement.scrollTop <= 0) {\n          this.stopAutoScroll();\n        }\n      } else {\n        this.stopAutoScroll();\n      }\n    }\n  }, {\n    key: 'hideDragLine',\n    value: function hideDragLine() {\n      if (this.dragLine) {\n        this.dragLine.style.display = 'none';\n      }\n    }\n  }, {\n    key: 'fixDragLine',\n    value: function fixDragLine(target) {\n      var dragLine = this.getDragLine();\n      if (!target || this.state.fromIndex < 0 || this.state.fromIndex === this.state.toIndex) {\n        this.hideDragLine();\n        return;\n      }\n\n      var _target$getBoundingCl = target.getBoundingClientRect(),\n          left = _target$getBoundingCl.left,\n          top = _target$getBoundingCl.top,\n          width = _target$getBoundingCl.width,\n          height = _target$getBoundingCl.height;\n\n      var lineTop = this.state.toIndex < this.state.fromIndex ? top : top + height;\n      if (this.props.enableScroll && this.scrollElement) {\n        var _scrollElement$getBou2 = this.scrollElement.getBoundingClientRect(),\n            scrollHeight = _scrollElement$getBou2.height,\n            scrollTop = _scrollElement$getBou2.top;\n\n        if (lineTop < scrollTop - 2 || lineTop > scrollTop + scrollHeight + 2) {\n          this.hideDragLine();\n          return;\n        }\n      }\n      dragLine.style.left = left + UNIT_PX;\n      dragLine.style.width = width + UNIT_PX;\n      dragLine.style.top = lineTop + UNIT_PX;\n      dragLine.style.display = 'block';\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this2 = this;\n\n      return _react2['default'].createElement(\n        'div',\n        { role: 'presentation', onMouseDown: this.onMouseDown, ref: function ref(c) {\n            _this2.dragList = c;\n          } },\n        this.props.children\n      );\n    }\n  }]);\n  return ReactDragListView;\n}(_react.Component);\n\nReactDragListView.propTypes = {\n  onDragEnd: _propTypes2['default'].func.isRequired,\n  handleSelector: _propTypes2['default'].string,\n  nodeSelector: _propTypes2['default'].string,\n  ignoreSelector: _propTypes2['default'].string,\n  enableScroll: _propTypes2['default'].bool,\n  scrollSpeed: _propTypes2['default'].number,\n  lineClassName: _propTypes2['default'].string,\n  children: _propTypes2['default'].node\n};\nReactDragListView.defaultProps = {\n  nodeSelector: DEFAULT_NODE_SELECTOR,\n  ignoreSelector: '',\n  enableScroll: true,\n  scrollSpeed: 10,\n  handleSelector: '',\n  lineClassName: '',\n  children: null\n};\nexports['default'] = ReactDragListView;\nmodule.exports = exports['default'];"]},"metadata":{},"sourceType":"script"}