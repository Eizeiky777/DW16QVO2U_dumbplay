{"ast":null,"code":"import { REGISTER, LOGIN } from \"../constants/action-types\";\nimport { API, setAuthToken } from \"../config/api\"; // import axios from \"axios\";\n// // Set config defaults when creating the instance\n// export const API = axios.create({\n//   baseURL: \"http://localhost:5000/api/v1\",\n// });\n// // Alter defaults after instance has been created\n// export const setAuthToken = (token) => {\n//   API.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n// };\n\nexport const register = user => {\n  return {\n    type: REGISTER,\n    payload: async () => {\n      try {\n        const {\n          data: {\n            data\n          }\n        } = await API.post(\"/register\", user);\n        localStorage.setItem(\"token\", data.token);\n        setAuthToken(data.token); //Set header token\n        // const {\n        //   data: { data: dataUser },\n        // } = await API.get(\"/user\");\n\n        const ids = data.id;\n        const {\n          data: {\n            data: dataUser\n          }\n        } = await API.get(\"/users/\" + ids);\n        localStorage.setItem(\"role\", dataUser.role);\n        localStorage.setItem(\"id\", dataUser.id);\n        return dataUser;\n      } catch (error) {\n        if (error.response) {\n          const {\n            data,\n            status\n          } = error.response;\n          if (status > 399) throw data.error;\n        }\n      }\n    }\n  };\n};\nexport const login = user => {\n  return {\n    type: LOGIN,\n    payload: async () => {\n      try {\n        const {\n          data: {\n            data\n          }\n        } = await API.post(\"/login\", user);\n        localStorage.setItem(\"token\", data.token);\n        setAuthToken(data.token); //Set header token\n\n        const ids = data.id;\n        const {\n          data: {\n            data: dataUser\n          }\n        } = await API.get(\"/users/\" + ids);\n        localStorage.setItem(\"role\", dataUser.role);\n        localStorage.setItem(\"id\", dataUser.id);\n        return dataUser;\n      } catch (error) {\n        if (error.response) {\n          const {\n            data,\n            status\n          } = error.response;\n          if (status > 399) throw data.error;\n        }\n      }\n    }\n  };\n};","map":{"version":3,"sources":["C:/1. Eizeiky/3. React/dumbways react/minggu_4 - Presentasi Final test/client/src/components/redux/actions/auth.js"],"names":["REGISTER","LOGIN","API","setAuthToken","register","user","type","payload","data","post","localStorage","setItem","token","ids","id","dataUser","get","role","error","response","status","login"],"mappings":"AAAA,SAASA,QAAT,EAAmBC,KAAnB,QAAgC,2BAAhC;AACA,SAASC,GAAT,EAAcC,YAAd,QAAkC,eAAlC,C,CAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,MAAMC,QAAQ,GAAIC,IAAD,IAAU;AAChC,SAAO;AACLC,IAAAA,IAAI,EAAEN,QADD;AAELO,IAAAA,OAAO,EAAE,YAAY;AACnB,UAAI;AACF,cAAM;AACJC,UAAAA,IAAI,EAAE;AAAEA,YAAAA;AAAF;AADF,YAEF,MAAMN,GAAG,CAACO,IAAJ,CAAS,WAAT,EAAsBJ,IAAtB,CAFV;AAIAK,QAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BH,IAAI,CAACI,KAAnC;AACAT,QAAAA,YAAY,CAACK,IAAI,CAACI,KAAN,CAAZ,CANE,CAMwB;AAE1B;AACA;AACA;;AACA,cAAMC,GAAG,GAAGL,IAAI,CAACM,EAAjB;AACA,cAAM;AAAEN,UAAAA,IAAI,EAAE;AAAEA,YAAAA,IAAI,EAAEO;AAAR;AAAR,YAA+B,MAAMb,GAAG,CAACc,GAAJ,CAAQ,YAAYH,GAApB,CAA3C;AACAH,QAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6BI,QAAQ,CAACE,IAAtC;AACAP,QAAAA,YAAY,CAACC,OAAb,CAAqB,IAArB,EAA2BI,QAAQ,CAACD,EAApC;AAEA,eAAOC,QAAP;AACD,OAjBD,CAiBE,OAAOG,KAAP,EAAc;AACd,YAAIA,KAAK,CAACC,QAAV,EAAoB;AAClB,gBAAM;AAAEX,YAAAA,IAAF;AAAQY,YAAAA;AAAR,cAAmBF,KAAK,CAACC,QAA/B;AAEA,cAAIC,MAAM,GAAG,GAAb,EAAkB,MAAMZ,IAAI,CAACU,KAAX;AACnB;AACF;AACF;AA3BI,GAAP;AA6BD,CA9BM;AAgCP,OAAO,MAAMG,KAAK,GAAIhB,IAAD,IAAU;AAC7B,SAAO;AACLC,IAAAA,IAAI,EAAEL,KADD;AAELM,IAAAA,OAAO,EAAE,YAAY;AACnB,UAAI;AACF,cAAM;AACJC,UAAAA,IAAI,EAAE;AAAEA,YAAAA;AAAF;AADF,YAEF,MAAMN,GAAG,CAACO,IAAJ,CAAS,QAAT,EAAmBJ,IAAnB,CAFV;AAIAK,QAAAA,YAAY,CAACC,OAAb,CAAqB,OAArB,EAA8BH,IAAI,CAACI,KAAnC;AACAT,QAAAA,YAAY,CAACK,IAAI,CAACI,KAAN,CAAZ,CANE,CAMwB;;AAE1B,cAAMC,GAAG,GAAGL,IAAI,CAACM,EAAjB;AACA,cAAM;AAAEN,UAAAA,IAAI,EAAE;AAAEA,YAAAA,IAAI,EAAEO;AAAR;AAAR,YAA+B,MAAMb,GAAG,CAACc,GAAJ,CAAQ,YAAYH,GAApB,CAA3C;AACAH,QAAAA,YAAY,CAACC,OAAb,CAAqB,MAArB,EAA6BI,QAAQ,CAACE,IAAtC;AACAP,QAAAA,YAAY,CAACC,OAAb,CAAqB,IAArB,EAA2BI,QAAQ,CAACD,EAApC;AAEA,eAAOC,QAAP;AACD,OAdD,CAcE,OAAOG,KAAP,EAAc;AACd,YAAIA,KAAK,CAACC,QAAV,EAAoB;AAClB,gBAAM;AAAEX,YAAAA,IAAF;AAAQY,YAAAA;AAAR,cAAmBF,KAAK,CAACC,QAA/B;AAEA,cAAIC,MAAM,GAAG,GAAb,EAAkB,MAAMZ,IAAI,CAACU,KAAX;AACnB;AACF;AACF;AAxBI,GAAP;AA0BD,CA3BM","sourcesContent":["import { REGISTER, LOGIN } from \"../constants/action-types\";\nimport { API, setAuthToken } from \"../config/api\";\n\n// import axios from \"axios\";\n// // Set config defaults when creating the instance\n// export const API = axios.create({\n//   baseURL: \"http://localhost:5000/api/v1\",\n// });\n// // Alter defaults after instance has been created\n// export const setAuthToken = (token) => {\n//   API.defaults.headers.common[\"Authorization\"] = `Bearer ${token}`;\n// };\n\nexport const register = (user) => {\n  return {\n    type: REGISTER,\n    payload: async () => {\n      try {\n        const {\n          data: { data },\n        } = await API.post(\"/register\", user);\n\n        localStorage.setItem(\"token\", data.token);\n        setAuthToken(data.token); //Set header token\n\n        // const {\n        //   data: { data: dataUser },\n        // } = await API.get(\"/user\");\n        const ids = data.id;\n        const { data: { data: dataUser } } = await API.get(\"/users/\" + ids );\n        localStorage.setItem(\"role\", dataUser.role);\n        localStorage.setItem(\"id\", dataUser.id);\n\n        return dataUser;\n      } catch (error) {\n        if (error.response) {\n          const { data, status } = error.response;\n\n          if (status > 399) throw data.error;\n        }\n      }\n    },\n  };\n};\n\nexport const login = (user) => {\n  return {\n    type: LOGIN,\n    payload: async () => {\n      try {\n        const {\n          data: { data },\n        } = await API.post(\"/login\", user);\n    \n        localStorage.setItem(\"token\", data.token);\n        setAuthToken(data.token); //Set header token\n\n        const ids = data.id;\n        const { data: { data: dataUser } } = await API.get(\"/users/\" + ids );\n        localStorage.setItem(\"role\", dataUser.role);\n        localStorage.setItem(\"id\", dataUser.id);\n\n        return dataUser;\n      } catch (error) {\n        if (error.response) {\n          const { data, status } = error.response;\n\n          if (status > 399) throw data.error;\n        }\n      }\n    },\n  };\n};\n"]},"metadata":{},"sourceType":"module"}